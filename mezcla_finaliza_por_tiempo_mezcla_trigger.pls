CREATE OR REPLACE EDITIONABLE TRIGGER "MEZCLA_FINALIZA_MEZCLA" 
AFTER
	update of "TIEMPO_MEZCLA" on "VARIABLE"
DECLARE
	v_tiempo_mezcla VARIABLE.TIEMPO_MEZCLA%TYPE;
	v_tiempo_final_de_mezcla PARAMETRO.TIEMPO_FINAL_DE_MEZCLA%TYPE;
BEGIN
	SELECT TIEMPO_MEZCLA INTO v_tiempo_mezcla FROM VARIABLE;
	SELECT TIEMPO_FINAL_DE_MEZCLA INTO v_tiempo_final_de_mezcla FROM PARAMETRO;

	IF v_tiempo_mezcla>v_tiempo_final_de_mezcla THEN
		UPDATE VARIABLE SET VALVULA='CERRADA';
	END IF;
END;
